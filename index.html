<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GISCO – Main Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* Default Theme - Modern */
    :root {
      --brand: #6366f1;
      --accent: #10b981;
      --bg: #f0fdf4;
      --surface: #dbeafe;
      --text: #1e293b;
      --muted: #64748b;
      --border: #e2e8f0;
      --card-bg: #ffffff;
      --hover: #f8fafc;
      --topbar-shadow: 0 10px 30px rgba(0,0,0,0.15);
      --card-shadow: 0 10px 25px rgba(0,0,0,0.08);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), #8b5cf6);
      --btn-primary-shadow: 0 6px 15px rgba(99, 102, 241, 0.4);
      --title-bg: rgba(255,255,255,0.15);
      --title-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    /* Modern Theme */
    .theme-modern {
      --brand: #6366f1;
      --accent: #10b981;
      --bg: #f0fdf4;
      --surface: #dbeafe;
      --text: #1e293b;
      --muted: #64748b;
      --border: #e2e8f0;
      --card-bg: #ffffff;
      --hover: #f8fafc;
      --topbar-shadow: 0 10px 30px rgba(0,0,0,0.15);
      --card-shadow: 0 10px 25px rgba(0,0,0,0.08);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), #8b5cf6);
      --btn-primary-shadow: 0 6px 15px rgba(99, 102, 241, 0.4);
      --title-bg: rgba(255,255,255,0.15);
      --title-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    /* Colorful Theme */
    .theme-colorful {
      --brand: #ff6b6b;
      --accent: #4ecdc4;
      --bg: #fff9c4;
      --surface: #a8e6cf;
      --text: #2d3436;
      --muted: #636e72;
      --border: #dfe6e9;
      --card-bg: #ffffff;
      --hover: #fff;
      --topbar-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
      --card-shadow: 0 10px 25px rgba(78, 205, 196, 0.2);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), #ff8e8e);
      --btn-primary-shadow: 0 6px 15px rgba(255, 107, 107, 0.4);
      --title-bg: rgba(255,255,255,0.2);
      --title-shadow: 0 6px 20px rgba(255, 107, 107, 0.3);
    }

    /* Business Theme */
    .theme-business {
      --brand: #2563eb;
      --accent: #059669;
      --bg: #f8fafc;
      --surface: #dbeafe;
      --text: #0f172a;
      --muted: #475569;
      --border: #cbd5e1;
      --card-bg: #ffffff;
      --hover: #f1f5f9;
      --topbar-shadow: 0 10px 30px rgba(37, 99, 235, 0.2);
      --card-shadow: 0 10px 25px rgba(5, 150, 105, 0.1);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), #3b82f6);
      --btn-primary-shadow: 0 6px 15px rgba(37, 99, 235, 0.4);
      --title-bg: rgba(255,255,255,0.1);
      --title-shadow: 0 6px 20px rgba(37, 99, 235, 0.2);
    }

    /* Classic Theme */
    .theme-classic {
      --brand: #7c3aed;
      --accent: #d946ef;
      --bg: #faf5ff;
      --surface: #ede9fe;
      --text: #1e1b4b;
      --muted: #5b21b6;
      --border: #e9d5ff;
      --card-bg: #ffffff;
      --hover: #f5f3ff;
      --topbar-shadow: 0 10px 30px rgba(124, 58, 237, 0.25);
      --card-shadow: 0 10px 25px rgba(217, 70, 239, 0.15);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), #8b5cf6);
      --btn-primary-shadow: 0 6px 15px rgba(124, 58, 237, 0.4);
      --title-bg: rgba(255,255,255,0.15);
      --title-shadow: 0 6px 20px rgba(124, 58, 237, 0.25);
    }

    /* Professional Theme */
    .theme-professional {
      --brand: #0f172a;
      --accent: #1e293b;
      --bg: #f1f5f9;
      --surface: #e2e8f0;
      --text: #0f172a;
      --muted: #475569;
      --border: #cbd5e1;
      --card-bg: #ffffff;
      --hover: #f8fafc;
      --topbar-shadow: 0 10px 30px rgba(15, 23, 42, 0.2);
      --card-shadow: 0 10px 25px rgba(30, 41, 59, 0.1);
      --btn-primary-bg: linear-gradient(135deg, var(--brand), var(--accent));
      --btn-primary-shadow: 0 6px 15px rgba(15, 23, 42, 0.3);
      --title-bg: rgba(255,255,255,0.1);
      --title-shadow: 0 6px 20px rgba(15, 23, 42, 0.2);
    }

    * { box-sizing: border-box; }
    body { 
      margin: 0; 
      background: var(--bg); 
      color: var(--text); 
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .topbar { 
      background: linear-gradient(135deg, var(--brand), var(--accent)); 
      color: #fff; 
      padding: 18px 22px; 
      box-shadow: var(--topbar-shadow); 
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      gap: 12px; 
      height: auto;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .logo { 
      height: 165px; 
      width: 500px; 
      border-radius: 20px; 
      box-shadow: 0 8px 25px rgba(0,0,0,0.2); 
    }
    .title { 
      font-weight: 800; 
      font-size: 28px; 
      letter-spacing: 0.5px; 
      color: #ffffff !important; 
      text-align: center;
      box-shadow: var(--title-shadow);
      padding: 20px;
      border-radius: 20px;
      background: var(--title-bg);
      backdrop-filter: blur(10px);
    }
    .subtitle { font-size: 14px; opacity: 0.95; }
    .theme-switch, .lang-switch { display: inline-flex; gap: 8px; align-items: center; }
    .theme-select { 
      height: 32px; 
      padding: 0 14px; 
      font-size: 13px; 
      min-width: 140px; 
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      color: white;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    .theme-select:hover {
      background: rgba(255,255,255,0.3);
    }
    .btn.small { 
      height: 32px; 
      padding: 0 14px; 
      font-size: 13px; 
      min-width: auto; 
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      color: white;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease;
    }
    .btn.small:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    .container { max-width: 1800px; margin: 32px auto; padding: 0 24px; }
    .grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
      gap: 32px; 
      justify-content: center;
    }
    .card { 
      background: var(--card-bg); 
      border: 2px solid var(--border); 
      border-radius: 20px; 
      padding: 24px; 
      box-shadow: var(--card-shadow); 
      display: grid; 
      gap: 16px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0,0,0,0.12);
    }
    .card h3 { 
      margin: 0; 
      font-size: 20px; 
      color: var(--text); 
      font-weight: 700;
    }
    .card p { 
      margin: 0; 
      color: var(--muted); 
      font-size: 14px; 
      line-height: 1.5;
    }
    .badge { 
      display: inline-flex; 
      align-items: center; 
      text-align: center; 
      font-size: 14px; 
      font-weight: 800; 
      color: #ffffff; 
      background: linear-gradient(135deg, #f59e0b, #ef4444);
      border-radius: 999px; 
      margin-inline-start: 12px; 
      height: 28px; 
      width: 70px; 
      justify-content: center;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
    }
    .actions { display: flex; gap: 12px; margin-top: 12px; flex-wrap: wrap; }
    .btn { 
      height: 42px; 
      padding: 0 20px; 
      border: 2px solid var(--border); 
      border-radius: 12px; 
      background: #fff; 
      color: var(--text); 
      display: inline-flex; 
      align-items: center; 
      gap: 10px; 
      cursor: pointer; 
      text-decoration: none; 
      white-space: nowrap; 
      min-width: 180px; 
      justify-content: center; 
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .btn.primary { 
      background: var(--btn-primary-bg);
      color: #ffffff; 
      border: none; 
      font-weight: 700;
      box-shadow: var(--btn-primary-shadow);
    }
    .btn.primary:hover { 
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(99, 102, 241, 0.6);
    }
    .btn:hover { 
      box-shadow: 0 6px 15px rgba(0,0,0,0.15); 
      transform: translateY(-2px);
      background: var(--hover);
    }
    .footer { margin-top: 20px; color: var(--muted); font-size: 12px; }
    .meta { 
      margin-top: 12px; 
      font-size: 14px; 
      color: var(--muted); 
      font-weight: 500;
    }
    .credit { 
      margin: 50px auto; 
      text-align: center; 
      font-size: 32px; 
      font-weight: 800; 
      color: var(--text); 
      letter-spacing: 0.8px;
      background: linear-gradient(135deg, var(--brand), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      padding: 30px;
      border-radius: 25px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    /* Responsive tweaks */
    .title { font-size: clamp(20px, 4vw, 28px); }
    .logo { height: clamp(100px, 12vw, 165px); width: auto; }
    @media (max-width: 900px){
      .topbar { flex-wrap: wrap; }
      .container { margin: 24px auto; }
      .title { font-size: clamp(18px, 6vw, 24px); padding: 15px; }
      .theme-controls { flex-direction: column; align-items: flex-start; gap: 12px; }
    }
    @media (max-width: 640px){
      .grid { grid-template-columns: 1fr; }
      .actions { flex-direction: column; align-items: stretch; }
      .actions .btn { width: 100%; min-width: 0; }
      .credit { font-size: 24px; padding: 20px; }
      .logo { height: 120px; }
    }
    
    /* Arabic font for date/time */
    .arabic-clock {
      font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    .clock-container {
      background: rgba(255,255,255,0.2);
      border-radius: 20px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
      min-width: 280px;
    }
    .time {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 8px;
      color: white;
    }
    .date {
      font-size: 16px;
      color: rgba(255,255,255,0.95);
      font-weight: 500;
    }
    
    .theme-controls {
      display: flex;
      gap: 16px;
      align-items: center;
    }
  </style>
  <!-- Arabic font for better Arabic text rendering -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="theme-modern">
  <header class="topbar">
    <img src="Logo.bmp" alt="GISCO logo" class="logo">
    
    <div class="title">شركة الخليج للخدمات الصناعية<br>Gulf Industrial Service Company</div>
    
    <div class="clock-container">
      <div class="time" id="time">--:--:--</div>
      <div class="date" id="date"></div>
    </div>

    <div class="theme-controls">
      <select class="theme-select" id="themeSelect">
        <option value="modern" style="color: black;">Modern</option>
        <option value="colorful"style="color: black;" >Colorful</option>
        <option value="business"style="color: black;">Business</option>
        <option value="classic" style="color: black;">Classic</option>
        <option value="professional" style="color: black;">Professional</option>
      </select>
      <div class="lang-switch" aria-label="Language Switch">
        <button class="btn small" data-lang="ar">عربي</button>
        <button class="btn small" data-lang="en">English</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <section class="card">
        <h3 data-i18n="card_oracle_title">Oracle Materials ( البحث في الاوراكل)</h3>
        <p data-i18n="card_oracle_desc">Enhanced search across Oracle.xlsx with multi-input filtering.</p>
        <div class="actions">
          <a class="btn primary" href="oracle.html" data-i18n="open_oracle">Open Oracle Page</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="oracleCount">loading…</span></div>
      </section>

      <section class="card">
        <h3 data-i18n="card_materials_title">Received Materials (البحث في المواد المستلمة)</h3>
        <p data-i18n="card_materials_desc">Same design, powered by Materials.xlsx with totals and search.</p>
        <div class="actions">
          <a class="btn primary" href="materials.html" data-i18n="open_materials">Open Materials Page</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="materialsCount">loading…</span></div>
      </section>

      <section class="card">
        <h3 data-i18n="card_requests_title">Requests Summary (البحث في ملخص الطلبات)</h3>
        <p data-i18n="card_requests_desc">Open the requests summary with search and filters.</p>
        <div class="actions">
          <a class="btn primary" href="Requests.html" data-i18n="open_requests">Open Requests Page</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="requestsCount">loading…</span></div>
      </section>

      <section class="card">
        <h3 data-i18n="card_sh_title">Al-Shuhrah Compressors (البحث في مواد محل الشهرة)</h3>
        <p data-i18n="card_sh_desc">Editable table with totals, export to Excel/PDF.</p>
        <div class="actions">
          <a class="btn primary" href="Shuhrah.html" data-i18n="open_sh">Open Al-Shuhrah Compressors</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="purchaseCount">loading…</span></div>
      </section>

      <section class="card">
        <h3><span data-i18n="card_wo_title">4378M Work Orders Summary</span><span class="badge" data-i18n="new_badge">New</span></h3>
        <p data-i18n="card_wo_desc">Open the 4378M work orders summary.</p>
        <div class="actions">
          <a class="btn primary" href="WO.html" data-i18n="open_wo">Open Work Orders Page</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="woCount">loading…</span></div>
      </section>

      <section class="card">
        <h3><span data-i18n="EMP_Card">4378M Staff Management</span><span class="badge" data-i18n="new_badge">New</span></h3>
        <p data-i18n="EMP_Card_Desc">Open 4378M Staff Management.</p>
        <div class="actions">
          <a class="btn primary" href="emp2.html" data-i18n="EMP_Card_Desc">Open 4378M Staff Management</a>
        </div>
        <div class="meta"><span data-i18n="data_label">Data:</span> <span id="empcount">loading…</span></div>
      </section>
    </div>

    <div class="credit">Programmed By Mostafa Al-Najar<br>تصميم وبرمجة م: مصطفي النجار</div>
  </main>

  <script>
    // Global variable to track current language
    let currentLang = 'ar';
    
    function updateClock() {
      const now = new Date();
      
      // Time formatting (same for both languages)
      const time = now.toLocaleTimeString('en-US', { hour12: false });
      document.getElementById('time').textContent = time;
      
      // Date formatting based on language
      if (currentLang === 'ar') {
        // Arabic date format with Arabic numerals
        const options = { 
          weekday: 'long', 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric',
          calendar: 'gregory'
        };
        
        // Get date parts in English first
        const day = now.toLocaleDateString('en-US', { day: 'numeric' });
        const month = now.toLocaleDateString('en-US', { month: 'long' });
        const year = now.toLocaleDateString('en-US', { year: 'numeric' });
        const weekday = now.toLocaleDateString('en-US', { weekday: 'long' });
        
        // Arabic translations
        const arabicWeekdays = {
          'Sunday': 'الأحد',
          'Monday': 'الاثنين',
          'Tuesday': 'الثلاثاء',
          'Wednesday': 'الأربعاء',
          'Thursday': 'الخميس',
          'Friday': 'الجمعة',
          'Saturday': 'السبت'
        };
        
        const arabicMonths = {
          'January': 'يناير',
          'February': 'فبراير',
          'March': 'مارس',
          'April': 'أبريل',
          'May': 'مايو',
          'June': 'يونيو',
          'July': 'يوليو',
          'August': 'أغسطس',
          'September': 'سبتمبر',
          'October': 'أكتوبر',
          'November': 'نوفمبر',
          'December': 'ديسمبر'
        };
        
        // Convert numbers to Arabic-Indic digits
        const arabicNumerals = {
          '0': '٠', '1': '١', '2': '٢', '3': '٣', '4': '٤',
          '5': '٥', '6': '٦', '7': '٧', '8': '٨', '9': '٩'
        };
        
        const convertToArabicNumerals = (numStr) => {
          return numStr.replace(/\d/g, d => arabicNumerals[d]);
        };
        
        const arabicDate = `${arabicWeekdays[weekday]}, ${convertToArabicNumerals(day)} ${arabicMonths[month]} ${convertToArabicNumerals(year)}`;
        document.getElementById('date').textContent = arabicDate;
        document.getElementById('date').className = 'date arabic-clock';
      } else {
        // English date format
        const date = now.toLocaleDateString('en-US', {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
        document.getElementById('date').textContent = date;
        document.getElementById('date').className = 'date';
      }
    }

    // Initialize and update clock every second
    setInterval(updateClock, 1000);
    updateClock(); // initial call
  </script>

  <script>
    // Theme switching functionality
    document.addEventListener('DOMContentLoaded', function() {
      const themeSelect = document.getElementById('themeSelect');
      const body = document.body;
      
      // Load saved theme from localStorage or default to modern
      const savedTheme = localStorage.getItem('selectedTheme') || 'modern';
      themeSelect.value = savedTheme;
      body.className = `theme-${savedTheme}`;
      
      // Theme change handler
      themeSelect.addEventListener('change', function() {
        const selectedTheme = this.value;
        body.className = `theme-${selectedTheme}`;
        localStorage.setItem('selectedTheme', selectedTheme);
      });
    });

    // Simple i18n dictionary and language persistence
    const I18N = {
      en: {
        brand_title: 'Gulf Industrial Service Company',
        card_oracle_title: 'Oracle Materials (Search Oracle)',
        card_oracle_desc: 'Enhanced search across Oracle.xlsx with multi-input filtering.',
        open_oracle: 'Open Oracle Page',
        card_materials_title: 'Received Materials (Search Received Materials)',
        card_materials_desc: 'Same design, powered by Materials.xlsx with totals and search.',
        open_materials: 'Open Materials Page',
        card_requests_title: 'Requests Summary (Search Requests Summary)',
        card_requests_desc: 'Open the requests summary with search and filters.',
        open_requests: 'Open Requests Page',
        card_sh_title: 'Al-Shuhrah Compressors (Search Al-Shuhrah Materials)',
        card_sh_desc: 'Editable table with totals, export to Excel/PDF.',
        open_sh: 'Open Al-Shuhrah Compressors',
        card_wo_title: '4378M Work Orders Summary',
        card_wo_desc: 'Open the 4378M work orders summary.',
        open_wo: 'Open Work Orders Page',
        EMP_Card: '4378M Staff Management',
        EMP_Card_Desc: 'Open 4378M Staff Management.',
        new_badge: 'New',
        data_label: 'Data:',
        rows_suffix: ' rows',
        file_not_found: 'file not found'
      
      },
      ar: {
        brand_title: 'شركة الخليج للخدمات الصناعية',
        card_oracle_title: 'مواد الاوراكل ( البحث في الاوراكل )',
        card_oracle_desc: 'بحث محسّن عبر Oracle.xlsx مع تصفية متعددة المدخلات.',
        open_oracle: '  الاوراكل',
        card_materials_title: 'المواد المستلمة ( البحث في المواد المستلمة )',
        card_materials_desc: 'نفس التصميم باستخدام Materials.xlsx مع المجاميع والبحث.',
        open_materials: '   المواد',
        card_requests_title: 'ملخص الطلبات ( البحث في ملخص الطلبات )',
        card_requests_desc: 'ا  ملخص الطلبات مع البحث والمرشحات.',
        open_requests: '   الطلبات ',
        card_sh_title: 'كومبيرسورز الشهرة ( البحث في مواد محل الشهرة )',
        card_sh_desc: 'جدول قابل للتعديل مع المجاميع والتصدير إلى Excel/PDF.',
        open_sh: '  محل الشهرة للكمبريسورز',
        card_wo_title: 'ملخص أوامر العمل 4378M',
        card_wo_desc: 'ا  ملخص أوامر العمل 4378M.',
        open_wo: '   أوامر العمل',
        new_badge: '  جديد ',
        EMP_Card: 'ادارة الموظفين ',
        EMP_Card_Desc: '  ادارة الموظفين.',
        data_label: 'تم العثور على:',
        rows_suffix: ' نتيجة ',
        file_not_found: 'الملف غير موجود'
      }
    };
    
    const getLang = () => currentLang;
    const applyLang = (lang) => {
      document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
      const dict = I18N[lang] || I18N.ar;
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
      });
      
      // Update global language variable and refresh clock
      currentLang = lang;
      updateClock();
    };
    const setLang = (lang) => { 
      currentLang = lang;
      applyLang(lang); 
    };
    
    function countRows(path){
      // Mock implementation since we can't access files in this environment
      const mockCounts = {
        'Oracle.xlsx': 1250,
        'Materials.xlsx': 890,
        'Requests.xlsx': 340,
        'sh.xlsx': 210,
        'WO.xlsx': 175,
        'EMP.xlsx': 85
      };
      return Promise.resolve(mockCounts[path] || 0);
    }
    
    function setCount(id, n){
      const el = document.getElementById(id);
      if (!el) return;
      const dict = I18N[getLang()] || I18N.ar;
      el.textContent = (typeof n === 'number') ? `${n}${dict.rows_suffix}` : dict.file_not_found;
    }
    
    document.addEventListener('DOMContentLoaded', async () => {
      // Apply language and wire toggle
      applyLang(getLang());
      document.querySelectorAll('[data-lang]').forEach(btn => 
        btn.addEventListener('click', () => setLang(btn.dataset.lang))
      );
      
      // Mock data counts for demonstration
      setCount('oracleCount', 58009);
      setCount('materialsCount', 890);
      setCount('requestsCount', 340);
      setCount('purchaseCount', 210);
      setCount('woCount', 175);
      setCount('empcount', 85);
    });
  </script>
</body>
</html>

